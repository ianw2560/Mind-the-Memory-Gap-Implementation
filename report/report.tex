\documentclass[11pt]{article}

\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{lmodern}
\usepackage{geometry}
\usepackage{graphicx}
\usepackage{amsmath, amssymb}
\usepackage{booktabs}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{hyperref}
\usepackage{fancyhdr}
\usepackage{siunitx}
\usepackage{xcolor}
\usepackage{listings}
\usepackage{tabularx,booktabs,array}
\newcolumntype{Y}{>{\raggedleft\arraybackslash}X} % right-aligned, wrapping

\geometry{
  a4paper,
  margin=1in
}

\title{Reinforcement Learning Adaptive Cruise Control Report}
\author{Ian Wallace}
\date{\today}

\begin{document}

\begin{equation}
\text{Throughput} = \frac{( \text{input\_tokens + output\_tokens} ) \times \text{batch\_size} }{ \text{decode\_time} } \\
\end{equation}

% OPT-1.3B
\begin{table}[htbp]
\centering
\caption{Throughput vs Peak Memory Allocation Trade-off (OPT-1.3B) with $B_{\mathrm{opt}}=64$}
\begin{tabularx}{\linewidth}{r Y Y Y Y}
\toprule
\textbf{Batch} & \textbf{Throughput (tokens/s)} & \textbf{\% of Max Throughput} & \textbf{\% of GPU Mem} & \textbf{Peak Mem Alloc (GB)} \\
\midrule
1   & 146.774  & 1.65\%  & 3.49\%  & 2.60  \\
2   & 285.705  & 3.21\%  & 3.62\%  & 2.70  \\
4   & 626.120  & 7.04\%  & 3.91\%  & 2.91  \\
8   & 1245.798 & 14.00\% & 4.49\%  & 3.34  \\
16  & 2456.956 & 27.61\% & 5.65\%  & 4.21  \\
32  & 4811.411 & 54.07\% & 7.96\%  & 5.93  \\
\textbf{64}  & \textbf{7554.474} & \textbf{84.89\%} & \textbf{12.58\%} & \textbf{9.38} \\
128 & 8298.988 & 93.26\% & 21.84\% & 16.27 \\
256 & 8898.890 & 100.00\% & 40.34\% & 30.05 \\
\bottomrule
\end{tabularx}
\end{table}


% OPT-2.7B
\begin{table}[htbp]
\centering
\caption{Throughput vs Peak-Alloc Trade-off (OPT-2.7B). Reported $B_{\mathrm{opt}}=64$ achieves 82.10\% of max throughput while using 21.33\% of GPU memory (peak\_alloc).}
\label{tab:tradeoff-opt-2.7b}
\begin{tabular}{rrrrr}
\toprule
\textbf{Batch} & \textbf{Throughput (tk/s)} & \textbf{\% of Max Throughput} & \textbf{\% of GPU Mem} & \textbf{Peak Mem Alloc (GB)} \\
\midrule
1   & 118.167  & 2.12\%  & 6.90\%  & 5.14  \\
2   & 233.970  & 4.20\%  & 7.15\%  & 5.33  \\
4   & 437.544  & 7.86\%  & 7.60\%  & 5.67  \\
8   & 954.037  & 17.14\% & 8.51\%  & 6.34  \\
16  & 1882.403 & 33.82\% & 10.34\% & 7.70  \\
32  & 3452.937 & 62.03\% & 14.00\% & 10.43 \\
\textbf{64}  & \textbf{4570.204} & \textbf{82.10\%} & \textbf{21.33\%} & \textbf{15.90} \\
128 & 5208.589 & 93.57\% & 36.00\% & 26.82 \\
256 & 5566.494 & 100.00\% & 65.32\% & 48.67 \\
\bottomrule
\end{tabular}
\end{table}

% Llama-2-13B
\begin{table}[htbp]
\centering
\caption{Throughput vs Peak-Alloc Trade-off (Llama-2-13B-hf). Reported $B_{\mathrm{opt}}=32$ achieves 74.85\% of max throughput while using 49.96\% of GPU memory (peak\_alloc).}
\label{tab:tradeoff-llama2-13b}
\begin{tabular}{rrrrr}
\toprule
\textbf{Batch} & \textbf{Throughput (tk/s)} & \textbf{\% of Max Throughput} & \textbf{\% of GPU Mem} & \textbf{Peak Mem Alloc (GB)} \\
\midrule
1  & 56.744   & 3.51\%  & 33.14\% & 24.69 \\
2  & 92.787   & 5.74\%  & 33.68\% & 25.10 \\
4  & 217.814  & 13.47\% & 34.77\% & 25.90 \\
8  & 443.518  & 27.42\% & 36.93\% & 27.51 \\
16 & 774.816  & 47.91\% & 41.27\% & 30.75 \\
\textbf{32} & \textbf{1210.680} & \textbf{74.85\%} & \textbf{49.96\%} & \textbf{37.22} \\
64 & 1617.373 & 100.00\% & 67.33\% & 50.16 \\
\bottomrule
\end{tabular}
\end{table}

% Llama-2-7B
\begin{table}[htbp]
\centering
\caption{Throughput vs Peak-Alloc Trade-off (Llama-2-7B-hf). Reported $B_{\mathrm{opt}}=64$ achieves 83.98\% of max throughput while using 39.42\% of GPU memory (peak\_alloc).}
\label{tab:tradeoff-llama2-7b}
\begin{tabular}{rrrrr}
\toprule
\textbf{Batch} & \textbf{Throughput (tk/s)} & \textbf{\% of Max Throughput} & \textbf{\% of GPU Mem} & \textbf{Peak Mem Allocation (GB)} \\
\midrule
1   & 70.558   & 2.29\%  & 17.25\% & 12.85 \\
2   & 141.461  & 4.58\%  & 17.59\% & 13.11 \\
4   & 283.086  & 9.17\%  & 18.30\% & 13.63 \\
8   & 559.652  & 18.13\% & 19.71\% & 14.68 \\
16  & 1090.758 & 35.34\% & 22.52\% & 16.78 \\
32  & 1886.349 & 61.12\% & 28.16\% & 20.98 \\
\textbf{64}  & \textbf{2592.036} & \textbf{83.98\%} & \textbf{39.42\%} & \textbf{29.37} \\
128 & 3086.485 & 100.00\% & 61.96\% & 46.16 \\
\bottomrule
\end{tabular}
\end{table}


\end{document}
